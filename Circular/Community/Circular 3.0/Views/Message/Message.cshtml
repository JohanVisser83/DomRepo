@model CircularWeb.Models.MessageModel;
@{
    Layout = "_Layout";
 }


<script type="text/javascript">
      var croppers = [];
      var fileImgNames=[];
      var fileType = [];
      var fileName ;
      var i;
      var imgss;

    $(document).ready(function () {
         $('.imageBox').hide();
         $('#btnCrop').hide();

        var options =
        {
            thumbBox: '.thumbBox',
            spinner: '.spinner',
        }
        var cropper = $('.imageBox').cropbox(options);
      
        $('#cover').on('change', function (e) {
                var file = e.target.files;
                 if((file[0].type) != "undefined")
                 {
                    for (i = 0; i < file.length; i++) 
                    {
                        fileImgNames.push(file[i].name);
                        fileType.push(file[i].type);
                    }
                     if(fileType[fileType.length-1] == "image/jpeg" || fileType[fileType.length-1] == "image/jpg" || fileType[fileType.length-1] == "image/png" )
                     {
                          $('.imageBox').show();
                          $('#btnCrop').show();

                        var reader = new FileReader();           
                        reader.onload = function (e) {  
                        options.imgSrc = e.target.result;                
                        cropper = $('.imageBox').cropbox(options);
                        console.log(cropper);
                        imgss = cropper.getDataURL(); 
                        console.log(imgss);
                        }               
                        reader.readAsDataURL(this.files[0]);
                     }
                     else
                     {
                           showThumbnail(file);
                     }
                 }
                
        })
     
        $('#btnCrop').on('click', function (e) {
            var img = cropper.getDataURL(); 
             
            $('.cropped').append('<img class="col-md-4" src="' + img + '"><div class="cross-icon image-icon pl-1"><button type="button" class="cross" onclick="dltCircleInfoItemsmessage(this)"><span aria-hidden="true" >×</span></button></div>');
            $('.cropped').each(function () {
                 croppers.push(img);
                $('.imageBox').hide();
                $('#btnCrop').hide();
            })
          
        })

       
        

   




 function showThumbnail(files) {
    for (let i = 0; i < files.length; i++) {
        let file = files[i];
        let thumbnail = document.getElementById("thumbnail");
        let pDiv = document.createElement("div");
        let video = document.createElement("video");
        let div = document.createElement("div");
        let crossDiv = document.createElement("div");
        let button = document.createElement("button");
        let span = document.createElement("span");

        pDiv.setAttribute('class', 'col-sm-4');
        thumbnail.appendChild(pDiv);
        video.setAttribute('class', 'imgKLIK5');
        pDiv.appendChild(video);
        div.setAttribute('class', 'closeDiv');
        pDiv.appendChild(div);
        crossDiv.setAttribute('class', 'cross-icon image-icon pl-2');
        div.appendChild(crossDiv);
        button.setAttribute('type', 'button');
        button.setAttribute('onclick', 'dltCircleInfoItemsmessageVedios(this)');
        crossDiv.appendChild(button);

        button.setAttribute('class', 'cross');
        //div.appendChild(crossDiv);
        span.setAttribute('aria-hidden', 'true');
        span.innerHTML = '×';
        button.appendChild(span);
        video.file = file;
        let reader = new FileReader()
        reader.onload = (function(aImg) {
            return function(e) {
                let blobURL = URL.createObjectURL(file);
                aImg.imgSrc = e.target.result;
                aImg.src = blobURL;
                aImg.setAttribute("controls", "");
                croppers.push(aImg.imgSrc);
            };
        }(video))
        reader.readAsDataURL(file);
        let canvas = document.createElement("canvas");
        let ctx = canvas.getContext("2d");
        video.onload = function() {
            ctx.drawImage(video, 100, 100);
        }
    }
}
});



function dltCircleInfoItemsmessageVedios(button) {
  
    let pDiv =  $(button).closest('.col-sm-4').prev('video');
    if (pDiv) {
         var indexToRemove = pDiv.index();  
         croppers.splice(indexToRemove, 1);
        pDiv.remove();
        $(button).closest('.col-sm-4').remove()
        $('#cover').val('');
        console.log(croppers);
    }
}




function dltCircleInfoItemsmessage(button) {
    var imageToRemove = $(button).closest('div').prev('img');
    var indexToRemove = imageToRemove.index();  
    croppers.splice(indexToRemove, 1);
    imageToRemove.remove();
    $(button).closest('div').remove();
    $('#cover').val('');   
    console.log(croppers);
}
</script>

<style>
.imageBox {
    position: relative;
       height: 323px;
    width: 465px;
    border: 1px solid #aaa;
    background: #fff;
    overflow: hidden;
    background-repeat: no-repeat;
    cursor: move;
}
 
    .imageBox .thumbBox {
              position: absolute;
                top: 50%;
                left: 50%;
                width: 432px;
                height: 300px;
                margin-top: -149px;
                margin-left: -216px;
                box-sizing: border-box;
                border: 1px solid rgb(102, 102, 102);
                box-shadow: 0 0 0 1000px rgba(0, 0, 0, 0.5);
                background: none repeat scroll 0% 0% transparent;
    }

        .imageBox .spinner {
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            text-align: center;
            line-height: 400px;
            background: rgba(0,0,0,0.7);
        }

         #thumbnail video{
                width:100%;
            }
             .cropped{
                 margin-bottom:20px;
                 position: relative;
             }
           /* .cropped img{
                margin:0 4px;
            }*/

/*            * {
    font-family: 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji', 'Apple Color Emoji', 'Segoe UI', 'Helvetica Neue', 'Arial', sans-serif;
}*/
</style>
<style>
    .circular-model.serch-community .form-control:focus, .circular-model.serch-user .form-control:focus {
        border-radius: 12px 12px 0 0;
    }

    .lstmymymebers {
        height: auto !important;
    }

    /*    .lstmymymebershq {
            height: auto !important;
        }*/

    .image_container {
        
        max-width: 200px;
        max-height: 450px;
        /*display:none;*/
    }

   


    .circular-model #logo-upload #imgfile1, .circular-model #logo-upload #imgfile2 {
        color: transparent;
        width: 100%;
        position: absolute;
        left: 0;
    }

    .circular-model #logo-upload2 #imgfile1, .circular-model #logo-upload2 #imgfile2 {
        color: transparent;
        width: 100%;
        position: absolute;
        left: 0;
    }

    

    .circular-model #Link-upload #imgfile1, .circular-model #Link-upload #imgfile2 {
        color: transparent;
        width: 100%;
        position: absolute;
        left: 0;
    }

    .circular-model #logo-upload11 #imgfile1, .circular-model #logo-upload11 #imgfile2 {
        color: transparent;
        width: 100%;
        position: absolute;
        left: 0;
    }

    .circular-model #logo-upload11 #imgfile1, .circular-model #logo-upload12 #imgfile2 {
        color: transparent;
        width: 100%;
        position: absolute;
        left: 0;
    }

        .circular-model #logo-upload11 #imgfile1, .circular-model #logo-upload127 #imgfile2 {
        color: transparent;
        width: 100%;
        position: absolute;
        left: 0;
    }


    .circular-model #logo-upload3 #imgfile3 {
        color: transparent;
        width: 100%;
        position: absolute;
        left: 0;
    }

    .circular-model #imgfile3::-webkit-file-upload-button {
        visibility: hidden;
    }

    .circular-model #logo-upload3 #imgfile4 {
        color: transparent;
        width: 100%;
        position: absolute;
        left: 0;
    }

    .circular-model #imgfile4::-webkit-file-upload-button {
        visibility: hidden;
    }

    .circular-model #logo-upload3 #imgfile4 {
        color: transparent;
        width: 100%;
        position: absolute;
        left: 0;
    }

    .circular-model #imgfile4::-webkit-file-upload-button {
        visibility: hidden;
    }

    .circular-model .custom-file-upload {
        padding: 6px 10px;
        text-align: left;
    }

    .circular-model #imgfile1::-webkit-file-upload-button, .circular-model #imgfile2::-webkit-file-upload-button {
        visibility: hidden;
    }


    .custom-file-upload1 {
        
      
        width: 100%;
        
        display: block;
        margin: 0 !important;
      
        color: #101c28 !important;
        font-weight: normal;
        font-size: 14px;
        position: absolute;
       
    }
.ui-menu .ui-menu-item a {
        font-size: 12px;
    }

    .ui-autocomplete {
         z-index: 1051 !important;
        float: left;
         height: 230px;
        overflow-y: auto;
            border-radius: 6px 6px 11px 11px;
    }

    .ui-widget.ui-widget-content {
        border: none !important;
    }

    .ui-menu li.ui-menu-item .ui-menu-item-wrapper {
        border-radius: unset;
    }

    .ui-widget.ui-widget-content {
        box-shadow: none;
        background: #ffffff;
        color: #101C28;
        font-size: 14px;
        font-weight: 500;
    }

    .ui-menu .ui-menu-item {
        margin-bottom: 3px;
    }
</style>

<div class="col-lg-11 col-md-11  col-sm-10 col-10">
<div class="body-content">
    <div class="row">
        <div class="col-lg-2">
            <div class="sidebar mt-38">

                <ul class="nav nav-tabs tab-data message-tab">
                    <li><a data-toggle="tab" href="#message" class="active">Inbox</a></li>
                    <li><a href="" data-toggle="modal" data-target="#NewMessage">New message</a></li>
                    <li><a href="" data-toggle="modal" data-target="#broadcast">New broadcast message</a></li>
                    <li><a data-toggle="tab" href="#broadcastlist">Broadcast messages</a></li>
                    <li><a data-toggle="tab" href="#archive">Message archive</a></li>
                    <li><a data-toggle="modal" href="#StartPoll" class="">Start a Poll</a></li>
                    <li><a data-toggle="tab" href="#PollResult" class="">Poll results</a></li>
                    <li><p class="tab-text">Newsfeed</p></li>
                    <li><a data-toggle="tab" href="#Active-articles">Active articles</a></li>
                    <li><a data-toggle="modal" data-target="#composeArticle">Post a new article</a></li>
                    <li><a data-toggle="tab" href="#article-archive">Article archive</a></li>
                </ul>
            </div>


        </div>
        <div class="col-lg-10">

            <div class="tab-content">
                <div id="message" class="tab-pane fade in active show">
                    <div class="cross-icon text-right d-block cross-relative planner-cross">

                        <button type="button" class="cross" id="Inboxcross">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>

                    <!-- For demo purpose-->
                    <div class="border-bx-area mb-4">
                        <div class="row no-gutters messahe-box ">
                            <!-- Users box-->
                            <div class="col-lg-4 px-0">
                                <div class="message-sidebar border-right h-100">

                                    <div class="messge-header">
                                        <h3 class="h5 mb-0 ">Message List</h3>
                                    </div>
                                     <div class="border-bottom"></div>
                                     
                                        @if (Model.lstMessages.Count() > 0)
                                       {
                                            <div class="unread-message-box ">
                                                  <div class=" form-group search-bar-list px-3">
                                                        <div class=" input-group diff">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text">
                                                                    <img src="~/images/Search-2.png" class="img-fluid">
                                                                </span>
                                                            </div>
                                                            <input class="form-control search" type="text" placeholder="Search message" id="SearchreadMessage">

                                                        </div>

                                                    </div>
                                                    <ul id="listreadMessage" class="h-190px overflow-auto">
                                                     @foreach (var item in Model.lstMessages)
                                                     {
                                                        <li>
                                                                <a class="d-flex justify-content-between align-content-center" href="javascript:void(0);">

                                                                    <div class="d-flex align-content-center">
                                                                        <div class="speaker-icon">
                                                                            @if(item.IsBroadcast == 1)
                                                                            {
                                                                                <img src="~/images/Volume-High.png" />
                                                                            }
                                                                        </div>

                                                                        <div class="username-bx">
                                                                        @if (item.IsUnread == 1)
                                                                        {
                                                                            <h6 class="titleSendername" style="font-weight:700"  title="@item.SenderFirstName"  editValue="@item.SenderId">@item.SenderFirstName *</h6>
                                                                        }
                                                                        else
                                                                        {
                                                                            <h6 class="titleSendername"  title="@item.SenderFirstName"  editValue="@item.SenderId">@item.SenderFirstName</h6>
                                                                        }
                                                                    </div>

                                                                    </div>

                                                                    <div class="right-icon archiveSend" data-toggle="modal" id="@item.SenderId">
                                                                        <img src="~/images/Down-Square1.png" />
                                                                    </div>

                                                                </a>

                                                        </li>
                                                     }

                                                    </ul>
                                            </div>
                                     }
                                </div>
                            </div>
                            <!-- Chat Box-->
                            <div class="col-lg-8 px-0">
                                <div class="chat-box bg-white chat-main-block">
                                    <div class="chat-header border-bottom">
                                        <p id="MessageTitle">Message</p>
                                    </div>
                                    <div id="messageSummary">
                                            @Html.Partial("~/Views/Partials/_MessageSummary.cshtml", Model)
                                    </div>
                                     
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- BroadCastList-->

                    <div id="broadcastlist" class="tab-pane fade">
                        <!-- For demo purpose-->
                        <div class="cross-icon text-right d-block cross-relative planner-cross">

                            <button type="button" class="cross" id="broad-castCross">
                                <span aria-hidden="true">×</span>
                            </button>
                        </div>
                        <div class="border-bx-area">
                            <div class="row no-gutters messahe-box  overflow-hidden">
                                <!-- Users box-->
                                <div class="col-lg-4 px-0">
                                    <div class="message-sidebar border-right h-100">

                                        <div class="messge-header">
                                            <h3 class="h5 mb-0">Broadcast messages</h3>
                                        </div>

                                          @if (Model !=null || Model.lstbroadcastMessage.Count() > 0)
                                        {
                                           
                                                <div class="unread-message-box not">
                                                    <div class=" form-group search-bar-list px-3">
                                                        <div class=" input-group diff">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text">
                                                                    <img src="~/images/Search-2.png" class="img-fluid">
                                                                </span>
                                                            </div>
                                                            <input class="form-control search" type="text" placeholder="Search Broadcast messages" id="searchBroadcastList">

                                                        </div>

                                                    </div>
                                                    <ul class="h-190px overflow-auto" id="listBroadcast">
                                                          @foreach(var item in Model.lstbroadcastMessage )
                                                          {
                                                         <li>
                                                        <a class="d-flex justify-content-between align-content-center" href="javascript:void(0);">
                                                                <div class="d-flex align-content-center">
                                                                    <div class="speaker-icon">

                                                                        <img src="~/images/Volume-High.png" />
                                                                    </div>
                                                                    <div class="username-bx">
                                                                    <h6 class="lblbroadcast" editValue="@item.Id">@item.Title</h6>
                                                                    </div>
                                                                </div>


                                                            </a>
                                                        </li>
                                                         }

                                                    </ul>
                                                   
                                               
                                                </div>
                                           
                                        }
                                    </div>
                                </div>
                                <!-- Chat Box-->
                                <div class="col-lg-8 px-0">
                                    <div class="chat-box bg-white chat-main-block">
                                        <div class="chat-header border-bottom">
                                            <p>Broadcast message details</p>
                                        </div>

                                        <div id="msgsummdata">
                                           
                                            @Html.Partial("~/Views/Partials/_BroadcastMessageSummary.cshtml", Model)
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>



                <!-- ====archive ==== -->
                <div id="archive" class="tab-pane fade">
                    <!-- For demo purpose-->
                    <div class="cross-icon text-right d-block cross-relative planner-cross">

                        <button type="button" class="cross" id="archived-cross">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="border-bx-area">
                        <div class="row no-gutters messahe-box  overflow-hidden">
                            <!-- Users box-->
                            <div class="col-lg-4 px-0">
                                    <div class="message-sidebar border-right h-100">

                                    <div class="messge-header">
                                        <h3 class="h5 mb-0">Archived messages</h3>
                                    </div>

                                        @if (Model != null || Model.lstArchivedMessage.Count() > 0)
                                        {
                                            <div class="unread-message-box ">
                                                <div class=" form-group search-bar-list px-3">
                                                    <div class=" input-group diff">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text">
                                                                <img src="~/images/Search-2.png" class="img-fluid">
                                                            </span>
                                                        </div>
                                                        <input class="form-control search" type="text" placeholder="Search archived messages" id="archiveSearch">

                                                    </div>

                                                </div>
                                                <ul class="h-190px overflow-auto" id="lista1archived">
                                                     @foreach (var item in Model.lstArchivedMessage)
                                                    {
                                                    <li>
                                                        <a class="d-flex justify-content-between align-content-center" href="javascript:void(0);">
                                                            <div class="d-flex align-content-center">
                                                                <div class="speaker-icon">

                                                                     @if(item.IsBroadcast == 1)
                                                                     {
                                                                         <img src="~/images/Volume-High.png" />
                                                                     }
                                                                </div>

                                                                <div class="username-bx">

                                                                        @if (item.IsUnread == 1)
                                                                        {
                                                                            <h6 class="lblArchived" style="font-weight:700"  title="@item.SenderFirstName"  editValue="@item.SenderId">@item.SenderFirstName *</h6>
                                                                        }
                                                                        else
                                                                        {
                                                                            <h6 class="lblArchived"  title="@item.SenderFirstName"  editValue="@item.SenderId">@item.SenderFirstName</h6>
                                                                        }




                                                                  @*  <h6 editvalue="@item.SenderId" class="lblArchived"> @item.SenderFirstName</h6>*@
                                                                </div>
                                                            </div>
                                                            <div class="right-icon UnArchivedMessage" id="@item.SenderId">
                                                                <img src="~/images/up-arrow.png" />
                                                            </div>
                                                        </a>
                                                    </li>
                                                    }
                                                </ul>

                                            </div>@*#NewMessage*@

                                        }
                                    </div>
                            </div>
                            <!-- Chat Box-->
                            <div class="col-lg-8 px-0">
                                <div class="chat-box bg-white chat-main-block">
                                    <div class="chat-header border-bottom">
                                        <p id="ArchiveMessage">Message</p>
                                    </div>

                                        <div id="archivedMessSummary">
                                            @Html.Partial("~/Views/Partials/_ArchivedMessageSummary.cshtml", Model)
                                        </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ====active articles==== -->
                <div id="Active-articles" class="tab-pane fade">
                    <!-- For demo purpose-->
                    <div class="cross-icon text-right d-block cross-relative planner-cross">

                        <button type="button" class="cross" id="btnCrossActivearticle">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="border-bx-area">
                        <div class="row no-gutters messahe-box  overflow-hidden">
                            <!-- Users box-->
                            <div class="col-lg-4 px-0">
                                <div class="message-sidebar border-right h-100">

                                    <div class="messge-header">
                                        <h3 class="h5 mb-0">Active articles</h3>
                                    </div>

                                       @if (Model != null || Model.lstNewsFeeds.Count() > 0)
                                        {
                                            <div class="unread-message-box ">

                                                <ul class="h-190px overflow-auto">
                                                      @foreach(var item in Model.lstNewsFeeds)
                                                {
                                                    <li>
                                                        <a class="d-flex justify-content-between align-content-center" href="javascript:void(0);">
                                                            <div class="d-flex align-content-center">

                                                                <div class="username-bx">
                                                                    <h6 class="mb-0 lblNewfeeds text-overr" editvalue="@item.Id" editvalue1="@item.Title" editvalue2="@item.WroteArticle", editvalue3="@item.MessageMedia" editvalue4="@item.MessageMediaThumbnail" editvalue5="@item.DocumentPath" editvalue6="@item.Summary">@item.Title</h6>
                                                                </div>
                                                            </div>
                                                            <div class="right-icon " >
                                                                @if(item.Isfeatured == 1)
                                                                    {
                                                                        <span class="pr-2 ArticleUnFeaturedSend" id="@item.Id"><img src="~/images/FilledPin.png" /></span>
                                                                    }
                                                                    else
                                                                    {
                                                                         <span class="pr-2 ArticleFeaturedSend" id="@item.Id"><img src="~/images/Pin.png" /></span>
                                                                    }
                                                                   
                                                              
                                                                     <span class="ArticlearchiveSend" id="@item.Id"><img src="~/images/Down-Square1.png" /></span>
                                                            </div>
                                                        </a>
                                                    </li>
                                                   
                                                }
                                                </ul>
                                               
                                            
                                            </div>
                                        }
                                    </div>
                            </div>
                            <!-- Chat Box-->
                            <div class="col-lg-8 px-0" id="_ActiveArticle1">
                             @Html.Partial("~/Views/Partials/_ActiveArticle.cshtml", Model)
                            </div>
                        </div>
                    </div>
                </div>

                <!--      ====end=== -->
                <!--  ====active articles==== -->
                <div id="article-archive" class="tab-pane fade">
                    <div class="cross-icon text-right d-block cross-relative planner-cross">

                        <button type="button" class="cross" id="article-archiveCross">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <!-- For demo purpose-->
                    <div class="border-bx-area">
                        <div class="row no-gutters messahe-box  overflow-auto ">
                            <!-- Users box-->
                            <div class="col-lg-4 px-0">
                                    <div class="message-sidebar border-right h-100">

                                    <div class="messge-header">
                                        <h3 class="h5 mb-0 ">Archive articles</h3>
                                    </div>


                                        @if (Model != null || Model.ArchivedArticle.Count() > 0)
                                        {
                                            <div class="unread-message-box ">

                                                <ul class="h-190px overflow-auto">
                                                     @foreach (var item in Model.ArchivedArticle)
                                                {
                                                  
                                                    <li>
                                                        <a class="d-flex justify-content-between align-content-center" href="javascript:void(0);">
                                                            <div class="d-flex align-content-center">

                                                                <div class="username-bx">
                                                                    <h6 class="mb-0 lblArchiveNewfeeds" editvalue="@item.Id" editvalue1="@item.Title" editvalue2="@item.WroteArticle" , editvalue3="@item.MessageMedia" editvalue4="@item.MessageMedia" editvalue5="@item.DocumentPath" editvalue6="@item.Summary">@item.Title</h6>
                                                                </div>
                                                            </div>

                                                            <div class="right-icon UnArchivedArticle" id="@item.Id">
                                                                <img src="~/images/up-arrow.png" />
                                                            </div>
                                                        </a>
                                                    </li>

                                                }
                                                </ul>
                                              
                                            </div>
                                        }
                                </div>
                            </div>
                            <!-- Chat Box-->
                                <div class="col-lg-8 px-0" id="_ArchiveArticle1">

                                     @Html.Partial("~/Views/Partials/_ArchiveArticle.cshtml", Model)
                                  
                                   
                                </div>
                        </div>
                    </div>
                </div>

                <!-- @*====end===*@ -->
                <!--  @* =====Custom Groups =====*@ -->
                <div id="PollResult" class="tab-pane fade new-event ">
                    <div class="safty-top-area">
                        <div class="row align-items-center">



                            <div class="ml-auto cross-icon text-right  cross-relative planner-cross">

                                <button type="button" class="cross ml-3" id="poll-crossbtn">
                                    <span aria-hidden="true">×</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="row custom-group-area">
                        <!--   @* ====col-4====*@ -->
                        <div class="col-lg-5 left-group">
                            <div class=" border-bx-area border-0">
                                <div class="table-responsive ">
                                    <table id="custom-groups" class="table tablesm-width">
                                        <thead>
                                            <tr>
                                                <th style="display:none"></th>
                                                <th class="text-left">Poll title</th>
                                                <th class="text-right">Delete Poll</th>

                                            </tr>
                                        </thead>
                                        <tbody>
                                            @if (Model.lstPolllist.Count() > 0)
										     {
                                                    foreach (var item in Model.lstPolllist)
                                                    {
                                                        <tr>
                                                            <td style="display:none">@item.Id </td>
                                                            <td editvalue="@item.PollTitle"  editValue1="@item.Question" editValue5="@item.Id" class="lblPollTitle text-left cursor:pointer"><a>@item.PollTitle</a></td>
                                                            <td class="text-right"><span class="dltpollbtn" id="@item.Id"><img src="~/images/Delete2.png"></span></td>
                                                        </tr>

                                                    }
                                                   
                                            }
                                            else
                                            {
                                                <tr>
                                            <td>  No Records Found!</td>
                                            </tr>
                                            }

                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <!-- @*=====end====*@-->
                        <!-- @* ====col-8===*@ -->
                            <div class="col-lg-7 left-group" id="PollResultsss">
                            
                                   @Html.Partial("~/Views/Partials/_PollResult.cshtml", Model)
                                  @* <div class=" border-bx-area" id="PollResult">
                                      
                                    
                                    </div>*@
                            
                            </div>
                        <!--    @* ====end=====*@ -->
                    </div>




                </div>
                <!--  @*==end===*@ -->
            </div>



        </div>


    </div>
</div>
</div>


<div class="overlay"></div>
    <!-- Modal -->
    <div class="modal fade modal-add-bx " id="NewMessage" tabindex="-1" aria-labelledby="NewMessagLabel" aria-hidden="true">
        <div class="modal-dialog w-500 modal-dialog-scrollable modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Compose a NEW message</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        &times;
                    </button>
                </div>
                <div class="modal-body">
                    <div class="new-message">
                        <form>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class=" form-group search-bar-list position-re">
                                        <div class=" input-group diff2">
                                            <input type="hidden" id="Number" value="" />
                                            <input class="form-control search " type="text"  placeholder="Search name or mobile number" id="ContactNo">
                                           @* <input type="hidden" id="ContactList" />*@
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">
                                                    <img src="~/images/Search-2.png" class="img-fluid">
                                                </span>
                                            </div>
                                        </div>
                                        <div>
                                            <ul id="ContactList">
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>Schedule delivery</label>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group">

                                                    <div class=" date-icon">
                                                        <input type="text" id="Scheduledate" class="form-control  btn-date">

                                                       
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <input type="time" class="form-control" id="ScheduleTime">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <textarea class="form-control" rows="8" id="Message"></textarea>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    @*<div class="row" id="logo-upload12">
                        <div class="offset-md-6 col-md-6">
                            
                            <div class="text-right">
                                <div class="add-icon-bx d-inline">
                                <label for="Articlepdfdoc" class="custom-file-upload1 nameimage1">
                                    <span></span>
                                </label>
                                </div>
                                <div class="add-icon-bx d-inline">
                                   
                                    <button type="button" class="btn-link btn"><img src="~/images/Document-add.png" /></button>
                                    <input type="file" name="myfile" id="pdffilesMessages" class="uploadMessPDF" accept=".pdf,.doc" />
                                </div>
                                <div class="add-icon-bx d-inline">
                                  
                                    <button type="button" class="btn-link btn"><img src="~/images/Image.png"></button>
                                    <input type="file" name="myfile" class="form-control uploadMessImg" id="imgfilesMessages">
                                   
                                </div>
                                <button type="button" class="btn btn-lumo-green SendMessage" data-toggle="modal" data-dismiss="modal" id="SendMessage">Send message</button>
                            </div>
                        </div>
                    </div>*@
                
                
                   <div class="row align-items-center" id="logo-upload12">
                        <div class="col-md-7">
                            <div class="cross-icon document-upld">
                            <label for="pdffilesMessages" class="custom-file-upload1 nameimage1" id="messPDF">
                                <span>
                                     
                                </span>
                            </label>
                           @* <button type="button" class="cross" id="crossbtn1">
                              ×
                           </button>*@
                            </div>
                        </div>
                        <div class="col-md-5">
                            <div class="text-right">
                            <div class="add-icon-bx d-inline">
                                <input type="file" id="pdffilesMessages">
                                
                                <button type="button" class="btn-link btn" id="pdfbtn"><img src="" /><img id="MessageImage" src="/images/Document-add.png" /></button>
                               
                            </div>
                           <button type="button" class="btn btn-lumo-green SendMessage" data-toggle="modal" data-dismiss="modal" id="SendMessage">Send message</button>
                        </div>
                        </div>
                    </div>
                
                
                
                
                </div>
            </div>
        </div>
    </div>
    <!--   @*=====modal popup Start a Poll==*@ -->
    <!-- StartPoll Modal -->
    <div class="modal fade modal-add-bx" id="StartPoll" tabindex="-1" aria-labelledby="boardcastLabel" aria-hidden="true">
        <div class="modal-dialog w-500 modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Start a Poll</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        &times;
                    </button>
                </div>
                <div class="modal-body">
                    <div class="new-message">
                        <form>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">

                                        <select class="form-control" data-placeholder="Select" tabindex="-1" onchange="onchangeStartpollMasterType(this)" id="ddlPollAudience">
                                            <option selected value="1">Select an audience</option>
                                            <option value="all">All</option>
                                            <option value="group">Group</option>
                                        </select>
                                    </div>

                                </div>
                                <div class="col-md-12">
                                    <div class="form-group select-wrap">

                                        <select class="form-control select-box allPollUsers" id="pollMasterUsers">
                                            <option selected>Select a group</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group ">
                                        <input type="text" class="form-control bg-boder-bx " placeholder="Give your poll a title" id="txtPollTile">
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group ">
                                        <input type="text" class="form-control bg-boder-bx " placeholder="Add a question" id="txtPollQue">
                                    </div>
                                </div>
                                <div class="col-md-12 mb-4">
                                    <div class="border-bottom"></div>
                                </div>

                                @* <div class="col-md-12">
                                    <div class="form-group ">
                                        <input type="text" class="form-control bg-boder-bx pollappend"  placeholder="Add a options" id="txtPoll_Options">
                                    </div>
                                </div>*@

                                
                                @*<div class="col-md-12 mb-4">
                                    <div class="border-bottom"></div>
                                </div>*@

                                @*<div class="col-md-12">
                                    <div class="form-group  add-icon-bx">
                                        <div class="form-control bg-boder-bx pt-3">Add an option</div>
                                        <div class="add-icon">
                                            <input type="file" name="myfile" class="form-control">
                                            <img src="~/images/Add-Circle.png">
                                        </div>
                                    </div>
                                </div>*@
                                <div class="col-md-12" id="abcstartpoll">
                                   @* <div class="form-group  add-icon-bx" >
                                        <div class="form-control bg-boder-bx  pt-3">Add an option</div>
                                        <div class="add-icon">
                                            <input type="file" name="myfile" class="form-control">
                                            <img src="~/images/Add-Circle.png">
                                        </div>
                                    </div>*@
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group ">
                                        <div class="fs-14" id="appendOption">+ Add options</div>

                                    </div>
                                </div>

                            </div>
                        </form>
                    </div>
                    <div class="text-right">
                        <button type="button" class="btn btn-lumo-green" id="SendPoll">Send poll</button>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!-- @*=====end=====*@ -->
    <!-- broadcast Modal -->
    <div class="modal fade modal-add-bx" id="broadcast" tabindex="-1" aria-labelledby="boardcastLabel" aria-hidden="true">
        <div class="modal-dialog w-500 modal-dialog-scrollable modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Compose a NEW broadcast message</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        &times;
                    </button>
                </div>
                <div class="modal-body">
                    <div class="new-message">
                        <form>
                            <div class="row">
                               @* <div class="col-md-12">
                                   <div class="form-group">
                                       <input type="text" class="form-control text-center"  id="ddlCommunity" value="@Model.CommunityName" readonly>
                                    </div>
                                </div>*@
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <select class="form-control text-center" onchange="onchangeMasterType(this)" id="ddlAudience">
                                            <option  selected value="1">Select an audience</option>
                                            <option value="all">All</option>
                                            <option value="group">Group</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group select-wrap ">
                                        <select class="form-control select-box text-center allUsers" id="ddlMasterUsers">
                                            <option selected>Select a group</option>
                                        
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>Schedule delivery</label>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="date-icon">
                                                    
                                                     <input type="date" id="Schedulebroadcastdate" class="form-control  btn-date">
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <input type="time" class="form-control" id="Schedulebroadcasttime" >
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <input type="text" class="form-control bg-boder-bx" placeholder="Insert your notification title" id="BroadcastTitle">
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <textarea class="form-control" rows="9" placeholder="Compose your message" id="BroadcastMess"></textarea>
                                    </div>
                                </div>
                            @*    <div class="col-md-7">
                                    <label for="imgfiles" id="lblBroadcastPdf">

                                    </label>
                                </div>*@
                            </div>
                        </form>
                    </div>
                    <div class="row align-items-center" id="logo-upload127">
                        <div class="col-md-5">
                             <div class="cross-icon document-upld">
                            <label for="pdffilesBroadcast" class="custom-file-upload1 nameimage1">
                                <span></span>
                            </label>
                            @* <button type="button" class="cross" id="crossbtn">
                              ×
                           </button>*@
                            </div>
                        </div>

                        <div class="col-md-7">
                             <div class="text-right">
                            <div class="add-icon-bx d-inline" id="btnpdfbroadcast">
                                <input type="file" id="pdffilesBroadcast">
                                <button type="button" class="btn-link btn"><img src="" /><img id="imageBroad" src="~/images/Document-add.png" /></button>
                               
                            </div>
                           <button type="button" class="btn btn-lumo-green button-class has-spinner" id="BroadCastMessage">Broadcast message</button>
                        </div>
                        </div>
                        
                       
                    </div>
                    


                  
                </div>
            </div>
        </div>
    </div>
    <!-- @*=====end=====*@ -->
    <!-- LeavePast Modal -->
    <div class="modal fade modal-small-bx" id="LeavePast" tabindex="-1" aria-labelledby="LeavePastLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div class="past-leave-box">
                        <h5>Leave it in the past.</h5>
                        <p>Are you sure you want to archive this item?</p>
                    </div>
                    <div class="text-center">
                       
                        <button type="button" class="btn mr-2" data-dismiss="modal" id="Noarchivemessage">No</button>
                         <button type="button" class="btn  " id="Archivemessagedone">Yes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- @*=====end=====*@ -->


     <!-- LeavePast Modal -->
    <div class="modal fade modal-small-bx" id="ArticleLeavePast" tabindex="-1" aria-labelledby="LeavePastLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div class="past-leave-box">
                        <h5>Leave it in the past.</h5>
                        <p>Are you sure you want to archive this item ?</p>
                    </div>
                    <div class="text-center">
                       
                        <button type="button" class="btn mr-2" data-dismiss="modal" id="NoArticlearchivemessage">No</button>
                         <button type="button" class="btn  " id="ArticleArchivedone">Yes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- @*=====end=====*@ -->


    <!-- Feature Artcile Modal -->

     <div class="modal fade modal-small-bx" id="ArticleFeature" tabindex="-1" aria-labelledby="LeavePastLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div class="past-leave-box">
                        @*<h5>Leave it in the past.</h5>*@
                        <p>Are you sure you want to feature this item?</p>
                    </div>
                    <div class="text-center">
                       
                        <button type="button" class="btn mr-2" data-dismiss="modal" id="NoArticlefeature">No</button>
                         <button type="button" class="btn  " id="Articlefeaturedone">Yes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--- End->

    <!--Remove Feature -->

     <div class="modal fade modal-small-bx" id="ArticleUnFeature" tabindex="-1" aria-labelledby="LeavePastLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div class="past-leave-box">
                        @*<h5>Leave it in the past.</h5>*@
                        <p>Are you sure you want to remove this from featured list?</p>
                    </div>
                    <div class="text-center">
                       
                        <button type="button" class="btn mr-2" data-dismiss="modal" id="NoArticleUnfeature">No</button>
                         <button type="button" class="btn  " id="ArticleUnfeaturedone">Yes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- End-->



    <!-- Unarchive Modal -->
    <div class="modal fade modal-small-bx" id="Unarchive" tabindex="-1" aria-labelledby="UnarchiveLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div class="past-leave-box">
                        <h5>Unarchive item</h5>
                        <p>Are you sure?</p>
                    </div>
                    <div class="text-center">
                          <button type="button" class="btn bg-lumo" id="UnArchivemessagedone">Yes</button>
                       
                         <button type="button" class="btn bg-pink" id="NoUnarchivemessage">No</button>
                      
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- @*=====end=====*@ -->

     <!-- UnarchiveArticle Modal -->
    <div class="modal fade modal-small-bx" id="UnarchiveArticle" tabindex="-1" aria-labelledby="UnarchiveLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div class="past-leave-box">
                        <h5>Unarchive item</h5>
                        <p>Are you sure?</p>
                    </div>
                    <div class="text-center">
                       
                        <button type="button" class="btn bg-pink" id="NoUnarchiveArticle">No</button>
                         <button type="button" class="btn bg-lumo" id="UnArchiveArticledone">Yes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- @*=====end=====*@ -->
    <!-- Archive Modal -->
    <div class="modal fade modal-small-bx" id="Archive" tabindex="-1" aria-labelledby="ArchiveLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div class="past-leave-box">
                        <h5>Locked down!</h5>
                        <p>Your article has been archived successfully.</p>
                    </div>
                    <button type="button" class="btn btn-default btn-block" id="closedArticle_archive">
                        <span aria-hidden="true">Close</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Message Archive-->
    <div class="modal fade modal-small-bx" id="MessageArchive" tabindex="-1" aria-labelledby="ArchiveLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div class="past-leave-box">
                        <h5>Locked down!</h5>
                        <p>Your message has been archived successfully.</p>
                    </div>
                    <button type="button" class="btn btn-default btn-block"  id="closeMessageArchive">
                        <span aria-hidden="true">Close</span>
                    </button>
                </div>
            </div>
        </div>
    </div>




    <!-- @*=====end=====*@ -->
    <!-- composeArticle Modal -->
    <div class="modal fade modal-add-bx" id="composeArticle" tabindex="-1" aria-labelledby="boardcastLabel" aria-hidden="true">
        <div class="modal-dialog  w-500 modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Compose a NEW article</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        &times;
                    </button>
                </div>
                <div class="modal-body">
                    <div class="new-message">
                        <form>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <input type="text" class="form-control bg-boder-bx" placeholder="Insert your article title" id="txtArticleTitle">
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <select class="form-control bg-boder-bx" onchange="onchangeArticleMasterType(this)" id="ddlArticleAudience">
                                            <option selected value="1">Select an audience</option>
                                            <option value="all">All</option>
                                            <option value="group">Group</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <select class="form-control bg-boder-bx allArticleUsers" id="ddlArticleMasterUsers">
                                            <option selected>Select a group</option>
                                            @*<option value="all">All</option>
                                            <option value="group">Group</option>*@
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <input type="text" class="form-control bg-boder-bx" placeholder="Who wrote this article?" id="txtWroteArticle">
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group  add-icon-bx" id="logo-upload2">
                                        <label for="cover" class="custom-file-upload nameimage bg-transparent">
                                            <span>Add cover media</span>
                                        </label>
                                        <div class="add-icon bg-white">
                                          @*onchange="readURL(this);"*@
                                            <input id="cover" type="file" accept="image/video/*"  />
                                            <img src="~/images/Add-Circle.png">
                                        </div>                         
                                    </div>
                                </div>


                                <div class="col-md-12">
                                    <div class="imageBox">
                                        <div class="thumbBox"></div>
                                        <div class="spinner" style="display: none">Loading...</div>
                                    </div>
                                     <div class="action">
                                        <input type="button" id="btnCrop" value="Crop">
                                    </div>
                                    <div class="cropped">

                                    </div>
                                    <div id="thumbnail" class="row m-0 video-thumb"></div>
                                </div>

                                <!-- // Will trigger crop event -->
                               
                                <div class="col-md-12">
                                    <div class="form-group ">
                                        <textarea class="form-control" rows="15" placeholder="Compose your article" id="txtcomposeArticle"></textarea>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="row align-items-center" id="logo-upload11">
                        <div class="col-md-4">
                             <div class="cross-icon document-upld">
                                <label for="Articlepdfdoc" class="custom-file-upload1 nameimage1 pt-0">
                                    <span></span>
                                </label>
                           </div>
                           
                        </div>
                        <div class="col-md-8">
                        <div class="text-right">
                            <div class="add-icon-bx d-inline">
                                <input type="file" id="Articlepdfdoc" accept=".pdf,.doc" class="w-100">
                                <button type="button" class="btn-link btn" >Attach a pdf<img src="~/images/Document-add.png" class="ml-1"/></button>
                               
                            </div>
                            <button type="button" class="btn btn-lumo-green button-class has-spinner" id="SendArticle">Post new article</button>
                        </div>
                       </div>
                    </div>
                   
                </div>
            </div>
        </div>
    </div>
    <!-- @*=====end=====*@ -->
    <!-- wentWrong Modal -->
    <div class="modal fade modal-small-bx" id="wentWrong" tabindex="-1" aria-labelledby="LeavePastLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div class="past-leave-box">
                        <h5>Oops!</h5>
                        <p id="ErrorMessage">Seems like something went wrong</p>
                    </div>
                    <div class="text-center">
                        <button type="button" class="btn btn-default btn-block" data-dismiss="modal">
                            <span aria-hidden="true">Close</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- @*=====end=====*@ -->
    <!-- successfull Modal -->
    <div class="modal fade modal-small-bx" id="successfull" tabindex="-1" aria-labelledby="LeavePastLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div class="past-leave-box">
                        <h5>Yippee!</h5>
                        <p>Your message has been sent successfully.</p>
                    </div>
                    <div class="text-center">
                        <button type="button" class="btn btn-default btn-block"  id="closmessagepopupbtn">
                            <span aria-hidden="true">Close</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- @*=====end=====*@ -->
    <!-- SpreadingNews Modal -->
    <div class="modal fade modal-small-bx" id="SpreadingNews" tabindex="-1" aria-labelledby="SpreadingNewsLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div class="past-leave-box">
                        <h5>Spreading the good news!</h5>
                        <p>Your article has been posted successfully.</p>
                    </div>
                    <div class="text-center">
                        <button type="button" class="btn btn-default btn-block" id="ArticleClosedPopup">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ======End====== -->
    <!-- pollSuccessfull Modal -->
    <div class="modal fade modal-small-bx" id="pollSuccessfull" tabindex="-1" aria-labelledby="LeavePastLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div class="past-leave-box">
                        <h5>Yippee!</h5>
                        <p>Your poll has been sent successfully.</p>
                    </div>
                    <div class="text-center">
                        <button type="button" class="btn btn-default btn-block" id="closePoll">
                            <span aria-hidden="true">Close</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- ======End====== -->



    <div class="modal fade modal-small-bx" id="pollmissingOptions" tabindex="-1" aria-labelledby="LeavePastLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div class="past-leave-box">
                        <h5>Oops!</h5>
                        <p>Poll should have atleast two options.</p>
                    </div>
                    <div class="text-center">
                        <button type="button" class="btn btn-default btn-block" id="closePollOptions" data-dismiss="modal">
                            <span aria-hidden="true">Close</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>












     <!-- pollSuccessfull Modal -->
    <div class="modal fade modal-small-bx" id="deleteSuccessfull" tabindex="-1" aria-labelledby="LeavePastLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div class="past-leave-box">
                        <h5>Are you sure?</h5>
                        <p>Your are about to delete this poll forever :(</p>
                    </div>
                    <div class="text-center">
                        <button type="button" class="btn bg-lumo" id="polldeletebtn">Yes</button>
                        <button type="button" class="btn bg-pink" id="" data-dismiss="modal">No</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- ======End====== -->


    <!-- PollResults Modal -->
    <div class="modal fade modal-add-bx small-datatable" id="PollResults1" tabindex="-1" aria-labelledby="PollResultsLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable w-500 modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title left-modal-title">Poll Results</h5>
                         <button type="button" class="btn btn-link text-white mr-5"><span class="mr-2"><img src="/images/Download-white.png" onclick="exportCSVExcelPollCollection()"></span>Export CSV</button>
                       
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            &times;
                        </button>
                   
                </div>
                <div class="modal-body p-0">
                    <div class="new-message">

                        <div class="row p-6">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Option</label>
                                    <input type="text" class="form-control " placeholder="" id="optiontxtfield">

                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Total votes</label>
                                    <input type="text" class="form-control " placeholder="" id="votess">

                                </div>
                            </div>

                        </div>
                        <div class="table-responsive h-48vh overflow-auto">
                            <table id="memeberList" class="table attendence ">
                                <thead>
                                    <tr>
                                        <th>Member</th>


                                    </tr>
                                </thead>
                                <tbody>

                                   @* <tr>
                                        <td id="userName"></td>

                                    </tr>*@
                                    

                                </tbody>
                            </table>
                        </div>
                    </div>

                </div>

            </div>

        </div>
    </div>


    <!-- @*======top jop update saved====*@ -->
<div class="modal fade modal-small-bx" id="Newmessagemessage" tabindex="-1" aria-labelledby="LeavePastLabel" aria-hidden="true">
	<div class="modal-dialog modal-sm modal-dialog-centered">
		<div class="modal-content">

			<div class="modal-body text-center">
				<div class="past-leave-box">
				
					<p id="messagesalemessage"></p>
				</div>
				<div class="text-center">

					<button type="button" class="btn btn-pink" data-dismiss="modal" id="closemessagemessage">Close</button>

				</div>

			</div>

		</div>
	</div>
</div>
<!-- @*======END======*@ -->


    <input type="hidden" id="dropdown" value="0" />

    <input type="hidden" id="articleDropdown"  value="0" />
    <input type="hidden" id="dropdownId" />
    <input type="hidden" id="Polldropdown" />
    <input type="hidden" id="typeofselection" value="" />
    <input type="hidden" id="selectionId" value=""/>

    <input type="hidden" id="articledropdownid" />
    <input type="hidden" id="polldropdownId" />
    <input type="hidden" id="articleTypeofselection" />
    <input type="hidden" id="Searchcustomerid" value="" />


    <input type="hidden" id="first" value="">
    <input type="hidden" id="second" value="">
    
    <input type="hidden" id="hiddenDateTimeField" value="" />

    <input type="hidden" id="MediaType" value="" />
 


    <script>

      
        

         $("#Link-upload .custom-file-upload span").show();
        $("#Link-upload input").change(function () {
            $("#Link-upload .custom-file-upload span").show();
            $("#Link-upload .custom-file-upload span").text(this.files[0].name);
        });

        $("#logo-upload11 .custom-file-upload1 span").show();
        $("#logo-upload11 input").change(function () {
            
            $("#logo-upload11 .custom-file-upload1 span").show();
            $("#logo-upload11 .custom-file-upload1 span").text(this.files[0].name);
            
        });

         $("#logo-upload12 .custom-file-upload1 span").show();
        $("#logo-upload12 input").change(function () {
            
            $("#logo-upload12 .custom-file-upload1 span").show();
            $("#logo-upload12 .custom-file-upload1 span").text(this.files[0].name);
           
        });

         $("#logo-upload127 .custom-file-upload1 span").show();
        $("#logo-upload127 input").change(function () {
            
            $("#logo-upload127 .custom-file-upload1 span").show();
            $("#logo-upload127 .custom-file-upload1 span").text(this.files[0].name);
           
        });

     </script>



    <script>
        $(document).ready(function () {
            $('#security').on('click', function () {
                $('.security-popup').addClass('visible');
                $('body').addClass('overl');
            });
            $('#request-payment').on('click', function () {
                $('.security-popup').addClass('visible');
                $('body').addClass('overl');
            });
            $('.overlay').click(function () {
                $('body').removeClass('overl');
                $('.security-popup').removeClass('visible');
            });




       
        
         $('#btnCrossActivearticle').click(function (e) {
            $('.message-tab   a[href="#message"]').tab('show');

        })

        $('#archived-cross').click(function (e) {
            $('.message-tab   a[href="#message"]').tab('show');

        })

        
        $('#poll-crossbtn').click(function (e) {
            $('.message-tab   a[href="#message"]').tab('show');

        })

        

         $('#article-archiveCross').click(function (e) {
            $('.message-tab   a[href="#message"]').tab('show');

        })

         

        });
    </script>
    <script>
 otable1 = $('#custom-groups').DataTable({
        "order": [[0, "desc"]],
        searching: false,
        pagination: false,

        "dom": 'rt<"bottom"flp><"bottom"i>'
    })
        
            otable2 = $('#Team-Setup').DataTable({
                "order": [[0, "desc"]],
                searching: false,
           
                pagination: false,
                "dom": 'rt<"bottom"flp><"bottom"i>'
            })
    </script>
    <script>
        $("#datepicker").datepicker({
            dayNamesMin: ['SUN', 'MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT'],
            showOtherMonths: true,
        });

        $("#datepickerto").datepicker({
            dayNamesMin: ['SUN', 'MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT'],
            showOtherMonths: true,
        });

    </script>
    <script>

        $(function () {

            $("#datefrom").datepicker();
            $("#Scheduledate").datepicker({
                dateFormat: 'dd-mm-yy'
            //beforeShow: function (input, inst) 
            //{         
            //$('.overlay').addClass('d-block');
            //},
            //onSelect: function (dateText, inst) {
            //$('.overlay').removeClass('d-block');
            //}
                
            });

            $("#datetime1").datepicker({
                beforeShow: function (input, inst) {              
                $('.overlay').addClass('d-block');
            },
            onSelect: function (dateText, inst) {
                $('.overlay').removeClass('d-block');
               

            },
            
            });
           
            //$("#Schedulebroadcastdate").datepicker({
            //    beforeShow: function (input, inst) {
               
            //    $('.overlay').addClass('d-block');
            //},
            //onSelect: function (dateText, inst) {
            //    $('.overlay').removeClass('d-block');


            //},
            
            // dateFormat: 'mm-dd-yy'
            //});

        //    $(".overlay").on("click", function () {
        //    $(".overlay").removeClass("d-block");
        //});
        });



        $(function () {
        var dtToday = new Date();

        var month = dtToday.getMonth() + 1;
        var day = dtToday.getDate();
        var year = dtToday.getFullYear();
        if (month < 10)
            month = '0' + month.toString();
        if (day < 10)
            day = '0' + day.toString();

        var minDate = year + '-' + month + '-' + day;

       
        $('#Schedulebroadcastdate').attr('min', minDate);
       

    });
       

 </script>

    
   
    <script type="text/javascript">

       
        $('#SendMessage').click(function () {
            var contactNo = $("#Searchcustomerid").val();
            var txtMessage = $("#Message").val();
            var pdfMessage = document.getElementById('pdffilesMessages');
            var ScheduleDate = $('#Scheduledate').val();
            var ScheduleTime = $('#ScheduleTime').val();
             var CombinedexpiryDate = ScheduleDate + ' ' + ScheduleTime;

            //var schedule = ScheduleDate +" "+ ScheduleTime;


            


            if (contactNo == "") {
            $('#ContactNo').focus();
            document.getElementById("ContactNo").style.border = "1px solid red";
            return false;
            }

           if ((ScheduleDate == "" || ScheduleDate==0) && (ScheduleTime == "" || ScheduleTime==0))
            {
                var formdata = new FormData();
                formdata.append('ToId', contactNo);
                formdata.append('Message', txtMessage);
              
                formdata.append('MessageExchangecode', 0);
                formdata.append('IsPaid', 0);
                formdata.append('newMessage', 1);
                formdata.append('Mediafile', pdfMessage.files[0]);

                $.ajax({
                    url: '/Message/SaveMessage',
                    type: 'POST',
                    cache: false,
                    contentType: false,
                    processData: false,
                    data: formdata,
                    dataType: 'json',
                    success: function (result) {
                        $('#successfull').modal('show')
                       // location.reload();
                    },
                    error: function () {

                        console.log('Failed ');
                    }
                });
            }
            else
            {
            
            var formdata = new FormData();
            formdata.append('ToId', contactNo);
            formdata.append('Message', txtMessage);
            formdata.append('MessageExchangecode', 0);
            formdata.append('Schedule', CombinedexpiryDate);
            formdata.append('ScheduleTime', CombinedexpiryDate)
            formdata.append('IsPaid', 0);
            formdata.append('newMessage', 1);
            formdata.append('Mediafile', pdfMessage.files[0]);
            

                $.ajax({
                    url: '/Message/SaveScheduleMessage',
                    type: 'POST',
                    cache: false,
                    contentType: false,
                    processData: false,
                    data: formdata,
                    dataType: 'json',
                    success: function (result) {
                        $('#successfull').modal('show')
                    },
                    error: function () {
                        console.log('Failed ');
                    }
            });
           }
        });

        $('#closmessagepopupbtn').click(function () {
             window.location.href = "/Message/Message?id=brodmessage";
                           
        })

      
    </script>

      

      <script>
        function onchangeMasterType(event) {
         
            $("#dropdown").val(event.value);

            var userType = event.value;
           

            if (userType == "all") {

                $('#ddlMasterUsers').hide();
                $('.allUsers').hide();
            }

            var Url = '/Message/DropDownGroupList';
            $.post(Url, { type: userType }, function (data) {
               
                if (data.length < 1) {
                    
                }
                var lstUsers = [];
                for (var i = 0; i <= data.length - 1; i++) {
                    
                    if (userType == "group") {
                       
                        lstUsers.push("<option value=" + data[i].id + ">" + data[i].groupName + "</option>")
                        
                       
                        $('.allUsers').show();
                        $('#ddlMasterUsers').show();
                       

                    }

                    if (userType == "all") {

                        $('#ddlMasterUsers').hide();
                        $('.allUsers').hide();
                    }
                }

                document.getElementById("ddlMasterUsers").innerHTML = "<option value='0'>Select a group</option>" + lstUsers;

              
              
                $('.preloader').addClass('hide').removeClass('show');
               
            })
        }
      </script>



    <script>
        function onchangeArticleMasterType(event) {

            $("#articleDropdown").val(event.value);

            var userType = event.value;


            if (userType == "all") {

                $('#ddlArticleMasterUsers').hide();
                $('.allArticleUsers').hide();
            }

            var Url = '/Message/DropDownGroupList';
            $.post(Url, { type: userType }, function (data) {

                if (data.length < 1) {

                }
                var lstUsers = [];
                for (var i = 0; i <= data.length - 1; i++) {

                    if (userType == "group") {

                        lstUsers.push("<option value=" + data[i].id + ">" + data[i].groupName + "</option>")
                        var grouplist = data[i].id
                        $("#articledropdownid").val(grouplist);
                        $('.allArticleUsers').show();
                        $('#ddlArticleMasterUsers').show();


                    }

                    if (userType == "all") {

                        $('#ddlArticleMasterUsers').hide();
                        $('.allArticleUsers').hide();
                    }
                }

                document.getElementById("ddlArticleMasterUsers").innerHTML = "<option value='0'>Select a group</option>" + lstUsers;

                $('.preloader').addClass('hide').removeClass('show');

            })
        }
    </script>

    <script>
        function onchangeStartpollMasterType(event) {

            $("#Polldropdown").val(event.value);

            var userType = event.value;


            if (userType == "all") {

                $('#pollMasterUsers').hide();
                $('.allPollUsers').hide();
            }

            var Url = '/Message/DropDownGroupList';
            $.post(Url, { type: userType }, function (data) {

                if (data.length < 1) {

                }
                var lstUsers = [];
                for (var i = 0; i <= data.length - 1; i++) {

                    if (userType == "group") {

                        lstUsers.push("<option value=" + data[i].id + ">" + data[i].groupName + "</option>")
                        var grouplist = data[i].id
                        $("#polldropdownId").val(grouplist);
                        $('.allPollUsers').show();
                        $('#pollMasterUsers').show();


                    }

                    if (userType == "all") {

                        $('#pollMasterUsers').hide();
                        $('.allPollUsers').hide();
                    }
                }

                document.getElementById("pollMasterUsers").innerHTML = "<option value='0'>Select a group</option>" + lstUsers;

                $('.preloader').addClass('hide').removeClass('show');

            })
        }
    </script>



    <script>
  
         $(document).on('click', "#SendChatbtn", function () {
        
         
            var txtMessChatInputfield = $('#chat-input').val().trim();
            var pdfMessage = document.getElementById('chatboximg11');
            if(txtMessChatInputfield == '' && pdfMessage == '')
            {
                return false;
            }

            var receiver = $('#toid').val();
            var formdata = new FormData()
             if (pdfMessage != '')
             {
                     formdata.append('Mediafile', pdfMessage.files[0]);
             }

            formdata.append('ToId', receiver);
            formdata.append('Message',txtMessChatInputfield);
            $.ajax({
                url: '/Message/SaveMessage',
                type: 'POST',
                cache: false,
                contentType: false,
                processData: false,
                data: formdata,
                dataType: 'json',
                success: function (result) {
                    location.reload();
                },
                error: function () {
                    console.log('Failed ');
                }
            });
        })


        //Autocomplete Search contactList and Name Functinality for Send Messasge



         $(function () {
            $("#ContactNo").autocomplete({
                source: function (request, response) {
                                 var searchList = $('#ContactNo').val()
                                 var formdata = new FormData();
                                 formdata.append('Search', searchList);
                        $.ajax({
                        url: '/Message/GetUserContactList',
                        data: formdata,
                        dataType: "json",
                        type: "POST",
                        contentType: false,
                        processData: false,
                        dataFilter: function (Result) { return Result; },
                        success: function (Result) {
                            console.log(Result)

                        for (var i = 0; i < Result.length; i++)
                        {
                             var Spont = Result[i].customerId;
                             $("#Searchcustomerid").val(Spont);
                        }
                           
                           console.log(Spont)
                            response($.map(Result, function (item) {
                                var x=  item.name + "(" + item.mobile + ")";
                                var y=  item.customerId;
                                    return {
                                         value: x,label: x,desc: y,
                                    }
                                }))
                            },
                            error: function (XMLHttpRequest, textStatus, errorThrown) {
                                var err = eval("(" + XMLHttpRequest.responseText + ")");
                               
                            }
                        });

                    },
                    select: function (e,i,s) {
                        $("#ContactNo").val(i.item.value);
                        $("#Searchcustomerid").val(i.item.desc);
                    },
                    focus: function (event, ui) {
                        event.preventDefault();
                    $('#ContactNo').val(ui.item.label);
                    },
                    minLength: 1 //This is the Char length of inputTextBox
                });

            });

        $('#BroadCastMessage').click(function() {
            var broadcastTitle = $("#BroadcastTitle").val();
            var message = $("#BroadcastMess").val();
            var drpvalue = $("#ddlAudience").val();
            var rdbtn = $("#selectval").val();
            var selecteddropdown = $("#dropdownId").val();
            var UploadImg = document.getElementById('pdffilesBroadcast')
            var GroupIdSelected = $('#ddlMasterUsers').val();
            var scheduleDate = $('#Schedulebroadcastdate').val();
            
            var schedulebroadcastTime = $('#Schedulebroadcasttime').val();
           
           

           //  var schedule = scheduleDate +' '+ schedulebroadcastTime;

            

             if(drpvalue == "1")
             {
              $('#ddlAudience').focus();
              document.getElementById("ddlAudience").style.border = "1px solid red";
              return false;
             }

      
        if(broadcastTitle == "") {
            $('#BroadcastTitle').focus();
            document.getElementById("BroadcastTitle").style.border = "1px solid red";
            return false;
        }
      
           


            if(drpvalue == "all")
            {
                var Isgroup = 0
                var ReferenceId = 0
            }else
            {
                var Isgroup = 1
                var ReferenceId = selecteddropdown
            }

             var btn = $(this);
             $(btn).buttonLoader('start');

               var CombinedstartDate = scheduleDate + ' ' + schedulebroadcastTime;
            var formdata = new FormData()
            formdata.append('Title',broadcastTitle);
            formdata.append('Text', message);
            formdata.append('SelectedId', GroupIdSelected);
            formdata.append('Type', drpvalue);
            formdata.append('IsGroup',Isgroup);
            formdata.append('ScheduleDateTime', CombinedstartDate);
            formdata.append('ScheduleTime', schedulebroadcastTime);
            formdata.append('ReferenceId', ReferenceId);
            formdata.append('Mediafile', UploadImg.files[0])
            
            $.ajax({
                url: '/Message/SendBroadcastMessage',
                type: 'POST',
                cache: false,
                contentType: false,
                processData: false,
                data: formdata,
                dataType: 'json',
                success: function (result) {
                    $(btn).buttonLoader('stop');
                    $('#successfull').modal('show')
                  
                },
                error: function () {

                    console.log('Failed ');
                }
            });
        })




        //getMessageDetails for selectedUser

        $(".titleSendername").on('click', function () {
        $("#listreadMessage li a h6").removeClass("active-bold");
        $(this).addClass("active-bold");
            $("#MessageTitle").text("Messages with " + $(this).attr("title"));
            var id = $(this).attr("editValue");
            var URL = "/Message/GetAdminConversations"
            $(this).prop('disabled', true);
            $(".preloader").removeClass("hide").addClass("show");

            $.post(URL, { Id: id }, function (data) {

                $(".preloader").removeClass("show").addClass("hide");
                $("#messageSummary").html(data);
                  setTimeout(() => {
                       var height = document.getElementById('chatArea').scrollHeight;
                      $( "#chatArea" ).scrollTop(height)
 
                    }, 500);

            });

        });


        //Get BroadcastSummary selected broadcast title

        $('.lblbroadcast').click(function() {
            $("#listBroadcast li a h6").removeClass("active-bold");
               $(this).addClass("active-bold");
            var id = $(this).attr("editValue");
            var URL = "/Message/GetBroadcastDetail"
          
            $.post(URL, { Id: id }, function (data) {
               
                $("#msgsummdata").html(data);

            });
        });

        // Archived MessageSummary Details functionality

        $('.lblArchived').click(function() {
        $("#lista1archived li a h6").removeClass("active-bold");
        $(this).addClass("active-bold");
            $("#ArchiveMessage").text("Messages with " + $(this).attr("title"));
            var id = $(this).attr("editValue");
            var URL = "/Message/GetArchivedMessageSummary"
            $.post(URL, {Id: id}, function (data) {

                $("#archivedMessSummary").html(data);
                setTimeout(() => {
                       var height = document.getElementById('chatArea-arhi').scrollHeight;
                      $( "#chatArea-arhi" ).scrollTop(height)
 
                    }, 500);
            })
        })


       

        // Message Archive functionality 

        $(".archiveSend").on('click', function () {
            var id = $(this).attr('id');
            $('#typeofselection').val(id);
            $('#LeavePast').modal('show');
        })


        $(document).on('click', '#Archivemessagedone', function () {
           
            var id = $('#typeofselection').val();

            var Aurl = "/Message/ArchivedMessage";

            $.post(Aurl, { UserId: id }, function (result) {

              $('#LeavePast').modal('hide');
             $('#MessageArchive').modal('show')


            });
           
          

          });




    </script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.0.0/cropper.min.css" integrity="sha256-FeDcPwV8ZgxG1MU5L/b2i8clOmqZJKK0eyDHqrQaXxY=" crossorigin="anonymous" />
       <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.0.0/cropper.min.js"></script>
    

    


    <script> 
   

        $("#SendArticle").click(function (){
      
            var articletitle = $('#txtArticleTitle').val();
            var composeArticle = $('#txtcomposeArticle').val();
           
            var drpvalue = $("#ddlArticleAudience").val();
            var rdbtn = $("#selectval").val();
            var selecteddropdown = $("#articledropdownid").val();
          
            var GroupIdSelected = $('#ddlArticleMasterUsers').val();
            var UploadArticlepdfdoc = document.getElementById('Articlepdfdoc');
            var uploadImg = document.getElementById('cover');
            var wroteArticle = $('#txtWroteArticle').val();


            var imgs = document.getElementById('cover');

             if (articletitle == "") {
               
             $('#txtArticleTitle').focus();
             document.getElementById("txtArticleTitle").style.border = "1px solid red";
             return false;
            }

            if(drpvalue == '1')
            {
               
             $('#ddlArticleAudience').focus();
             document.getElementById("ddlArticleAudience").style.border = "1px solid red";
             return false;
            }

            if (wroteArticle == "") {
          
                $('#txtWroteArticle').focus();
                document.getElementById("txtWroteArticle").style.border = "1px solid red";
                return false;
            }

            //if (composeArticle == "") {
            //    alert('4');
            //    $('#txtcomposeArticle').focus();
            //    document.getElementById("txtcomposeArticle").style.border = "1px solid red";
            //    return false;
            //}

            if (!uploadImg.files || !uploadImg.files.length) 
            {              
               $('#logo-upload2').focus();
               document.getElementById("logo-upload2").style.border = "1px solid red";
               return false;
            }
            
            
            if (drpvalue == "all") {
                var Isgroup = 0
                var ReferenceId = 0
            } else {
                var Isgroup = 1
                var ReferenceId = selecteddropdown
            }

            var btn = $(this);
            $(btn).buttonLoader('start');

            


            var formdata = new FormData()
            formdata.append('Title', articletitle);
            formdata.append('Summary', composeArticle);
            formdata.append('SelectedId', GroupIdSelected);
            formdata.append('Type', drpvalue);
            formdata.append('IsGroup', Isgroup);
            formdata.append('ReferenceId', ReferenceId);
            formdata.append('WroteArticle', wroteArticle);
            formdata.append('Mediafile', uploadImg.files[0]);
            formdata.append('Mediafile', UploadArticlepdfdoc.files[0]);

           

            if(croppers.length == 0)
            {
                 var articleMediaItems = croppers; 
                 formdata.append('Mediafile', imgs);
                 formdata.append("ArticleMedia[0].filename", fileImgNames);
                 formdata.append("ArticleMedia[0].MediaType", fileType); 
            }
            else 
            {
                for (var i = 0; i < croppers.length; i++) {
                    var articleMediaItem = croppers[i];           
                    formdata.append("ArticleMedia[" + i + "].Media", articleMediaItem);    
            
                    var articleMediafilename = fileImgNames[i];           
                    formdata.append("ArticleMedia[" + i + "].filename", articleMediafilename);  

                    var articleMediaType = fileType[i];           
                    formdata.append("ArticleMedia[" + i + "].MediaType", articleMediaType);   
                }
          }
            


             

            $.ajax({
                url: '/Message/SendNewFeeds',
                type: 'POST',
                cache: false,
                contentType: false,
                processData: false,
                data: formdata,
                dataType: 'json',
                success: function (result) {
                    $(btn).buttonLoader('stop');
                    $('#composeArticle').modal('hide')
                    $('#SpreadingNews').modal('show')
                   
                   
                },
                error: function () {

                    console.log('Failed ');
                }
            });
        })

        

        $(".lblNewfeeds").on('click', function () {
           $(".unread-message-box ul li a h6").removeClass("active-bold");
             $(this).addClass("active-bold");
             var id = $(this).attr("editvalue");
             var URL = "/Message/GetActiveArticleDetails"
             $.post(URL, { Id: id }, function (result) {
                 console.log(result)
                 $('#_ActiveArticle1').html(result);
            });
        });

        $(".lblArchiveNewfeeds").on('click', function () {
        $(".unread-message-box ul li a h6").removeClass("active-bold");
             $(this).addClass("active-bold");
             var id = $(this).attr("editvalue");
             var URL = "/Message/GetArchivedArticleDetails"
             $.post(URL, { Id: id }, function (result) {
                 console.log(result)
                 $('#_ArchiveArticle1').html(result);
            });
          
        });

        // Article Archive Functinality

        $(".ArticlearchiveSend").on('click', function () {
            var id = $(this).attr('id');
            $('#typeofselection').val(id);
            $('#ArticleLeavePast').modal('show');
            
        })

        $(".ArticleFeaturedSend").on('click', function () {
            var id = $(this).attr('id');
            $('#typeofselection').val(id);
            $('#ArticleFeature').modal('show');
        })

        

          $(".ArticleUnFeaturedSend").on('click', function () {
            var id = $(this).attr('id');
            $('#typeofselection').val(id);
            $('#ArticleUnFeature').modal('show');
        })
        

        $(document).on('click', '#ArticleArchivedone', function () {
          
            var id = $('#typeofselection').val();

            var Aurl = "/Message/ArchivedArticle";

            $.post(Aurl, { Id: id }, function (result) {
                 $('#ArticleLeavePast').modal('hide');
                 $('#Archive').modal('show');

             // location.reload();

            });
        });


        $(document).on('click', '#Articlefeaturedone', function () {
          
            var id = $('#typeofselection').val();

            var Aurl = "/Message/FeatureArticle";

            $.post(Aurl, { Id: id }, function (result) {
                 $('#ArticleFeature').modal('hide');

                 location.reload();

            });
        });

        $(document).on('click', '#ArticleUnfeaturedone', function () {
          
            var id = $('#typeofselection').val();

            var Aurl = "/Message/UnFeatureArticle";

            $.post(Aurl, { Id: id }, function (result) {
                 $('#ArticleUnFeature').modal('hide');

                 location.reload();

            });
        });


        $(".UnArchivedMessage").on('click', function () {

            var id = $(this).attr('id');
            $('#typeofselection').val(id);
            $('#Unarchive').modal('show');
        })

        $(".UnArchivedArticle").on('click', function () {

            var id = $(this).attr('id');
            $('#typeofselection').val(id);
            $('#UnarchiveArticle').modal('show');
        })
            
        $('#UnArchivemessagedone').click(function () {

            var id = $('#typeofselection').val();
            var Aurl = "/Message/UnArchivedMessage";
            $.post(Aurl, { ArchivedUserid: id }, function (result) {

             location.reload();

            })
        })

        $('#UnArchiveArticledone').click(function () {
            var id = $('#typeofselection').val();
            var Aurl = "/Message/UnArchivedArticle";
            $.post(Aurl, { ArchivedUserid: id }, function (result) {

                location.reload();

            })
        })

        $(document).on('click', '#NoUnarchivemessage', function () {
            $("#Unarchive").modal("hide");
        });
       
        $(document).on('click', '#NoUnarchiveArticle', function () {
            $("#UnarchiveArticle").modal("hide");
        });

    </script>

       
      
     



       <!-- Poll Funtionality Added By Shashikant-->
      
       <script>
        $(document).ready(function() {
        var max_fields    = 10; //maximum input boxes allowed
        var add_button    = $("#appendOption"); //Add button ID

        var x = 1; //initlal text box count
        $(add_button).click(function(e){ //on add input button click
         e.preventDefault();
         // if(x < max_fields){ 
         //   x++;         
        $('#abcstartpoll').append('<div class="form-group abc2"><input type="text" name="mytext[]" class="form-control bg-boder-bx pollappend" placeholder="Add a options" id="txtpolloption[]"></div>')
        
        
        //}
       });
});


      </Script>
     
    <!-- Send Poll Funtionality Added By Shashikant-->
     
       <script>
          var countOption = []        
           
           $('#SendPoll').on('click', function () {
      
            var a = $(".pollappend");
            var textOps = $("input[name='mytext[]']")
            .map(function(){return $(this).val();}).get();

            var selecteddropdown = $("#polldropdownId").val();
           // var GroupIdSelected = $('#pollMasterUsers').val();
            var polltitle = $('#txtPollTile').val();
            var txtQuestion = $('#txtPollQue').val();
            var drpvalue = $("#ddlPollAudience").val();


            if(textOps.length < 2)
            {
                $('#pollmissingOptions').modal('show');
                return false;
            }
          

            if(drpvalue == '1')
            {
               $('#ddlPollAudience').focus();
               document.getElementById("ddlPollAudience").style.border = "1px solid red";
               return false;
            }




            if (polltitle == "") {
               $('#txtPollTile').focus();
               document.getElementById("txtPollTile").style.border = "1px solid red";
               return false;
            }
            if (txtQuestion == "") {
               $('#txtPollQuestion').focus();
               document.getElementById("txtPollQuestion").style.border = "1px solid red";
               return false;
            }
       

             if (drpvalue == "all") {
                var Isgroup = 0
            } else {
                var Isgroup = 1
                var ReferenceId = selecteddropdown
            }
            


            var formdata = new FormData();
            formdata.append('Question', txtQuestion);
            formdata.append('PollTitle', polltitle);
            formdata.append('Type', drpvalue)
            formdata.append('ReferenceId', selecteddropdown);
            
            formdata.append('Options[0].OptionText', textOps);
            
            
             

            $.ajax({
                url: '/Message/SendPoll',
                type: 'POST',
                cache: false,
                contentType: false,
                processData: false,
                data: formdata,
                dataType: 'json',
                success: function (result) {
                    $('#StartPoll').modal('hide');
                    $('#pollSuccessfull').modal('show');
                    
                    //$('.message-tab a[href="#PollResult"]').tab('show');

                },
                error: function () {

                    console.log('Failed ');
                }
            });

          })


         $('.lblPollTitle').click(function () {
            $("#custom-groups tr td").removeClass("active-bold");
              $(this).addClass("active-bold");
            var id = $(this).attr("editValue5");
            
            var URL = "/Message/GetPollDetails"
            $.post(URL, { PollId: id }, function (result) {
               
                console.log(result)
                 $('#PollResultsss').html(result);
                 

            });
         });
       
        


      // Poll Delete Functionality Added By Shashikant 
       
        $(".dltpollbtn").on('click', function () {
            var id = $(this).attr('id');
            $('#typeofselection').val(id);
            $('#deleteSuccessfull').modal('show');
        })


        $('#polldeletebtn').on('click', function() {
            var Id = $('#typeofselection').val();
            var Aurl = "/Message/DeletePoll"
            $.post(Aurl, { id: Id }, function (result) {
              location.reload();
                  // $('#pollSuccessfull').modal('show');
                    $('.message-tab a[href="#PollResult"]').tab('show');
            });

 
        })

       

   
       </script>

    <script>
       

        $("#SearchreadMessage").on("keyup", function() {
        var value = this.value.toLowerCase().trim();
        $("#listreadMessage li").show().filter(function() {
        return $(this).text().toLowerCase().trim().indexOf(value) == -1;
        }).hide();
        });


        $("#archiveSearch").on("keyup", function() {
        var value = this.value.toLowerCase().trim();
        $("#lista1archived li").show().filter(function() {
        return $(this).text().toLowerCase().trim().indexOf(value) == -1;
        }).hide();
        });



        $("#searchBroadcastList").on("keyup", function() {
        var value = this.value.toLowerCase().trim();
        $("#listBroadcast li").show().filter(function() {
        return $(this).text().toLowerCase().trim().indexOf(value) == -1;
        }).hide();
        });


        








     
    
</script>

<script>
         $('#ddlMasterUsers').change(function() {
             var val = $(this).val(); 
             $("#dropdownId").val(val);
         })

         $('#ddlArticleMasterUsers').change(function() {
             var val = $(this).val(); 
             $("#articledropdownid").val(val);
         })

        $('#pollMasterUsers').change(function() {
            var val = $(this).val(); 
            $("#polldropdownId").val(val);
        })
       
        $('#closeMessageArchive').click(function() {
            location.reload();
        })
      
        $('#closedArticle_archive').click(function() {
            location.reload();
        })

        $('#closePoll').click(function() {

               window.location.href = "/Message/Message?id=poll";

        })

        

        $('#ArticleClosedPopup').click(function() {
                window.location.href = "/Message/Message?id=article";
        })
</script>

<script>
 

   
// window.reset = function(e) {
//  e.wrap('<div>').closest('div').get(0).reset();
//  e.unwrap();
//}

    //$('#crossbtn1').click(function () {
           //$('#pdffilesMessages').val('');
           // $('input[type=file]').val('');
            //$('input[type=file]').replaceWith($('input[type=file]').clone(true));
          
          // $('#messPDF').text('');
       //})

  
   $(document).ready(function () {

        //if (~window.location.href.indexOf("brodmessage")) {
        //    $('.message-tab a[href="#broadcastlist"]').tab('show');
        //}
         if (~window.location.href.indexOf("poll")) {
            $('.message-tab a[href="#PollResult"]').tab('show');
        }
         if (~window.location.href.indexOf("article")) {
            $('.message-tab a[href="#Active-articles"]').tab('show');
        }

        $('#Inboxcross').click(function (e) {
      
        window.location.href = '@Url.Action("Dashboard", "Dashboard")';

         })

        $('#broad-castCross').click(function (e) {
             $('.message-tab   a[href="#message"]').tab('show');
        })

       
    });

</script>
<script>
$(document).ready(function() {
  setTimeout(() => {
   var height = document.getElementById('chatArea').scrollHeight;
  $( "#chatArea" ).scrollTop(height)
 
}, 1000);
});
</script>

<script>
    function exportCSVExcelPollCollection() {
        var  xlss = "Poll Result"
            const currentDate = new Date();
            const day = String(currentDate.getDate()).padStart(2, '0');
            const month = String(currentDate.getMonth() + 1).padStart(2, '0');
            const year = currentDate.getFullYear();
            const formattedDate = `${day}-${month}-${year}`;
        var filename = xlss + `_${formattedDate}.xls`;

            $('#memeberList').table2excel({
                exclude: ".no-export",
                filename: filename,
                fileext: ".xls",
                exclude_links: true,
                exclude_inputs: true
            });
    }

    // Send Message functionality either Text or Pdf/Img
        

          $(document).ready(function() {
          $('#Message').on('input', function() {
        
            if ($(this).val().trim() !== '')
            {
              
             $('#MessageImage').hide();

              $('#pdffilesMessages').prop('disabled', true);
            } 
            else
            {
             $('#MessageImage').show();

              $('#pdffilesMessages').prop('disabled', false);
            }

          });

         });

          $('#pdffilesMessages').on('change', function () {
          $('#Message').prop('readonly', true)

         });






        // Send BroadcastMessage functionality either Text or Pdf/Img


          $(document).ready(function() {
          $('#BroadcastMess').on('input', function() {
          
            if ($(this).val().trim() !== '')
            {
              
              $('#btnpdfbroadcast').hide();
              $('#imageBroad').hide();
              $('#pdffilesBroadcast').prop('disabled', true);
            } 
            else
            {
              $('#btnpdfbroadcast').show();
              $('#imageBroad').show();
              $('#pdffilesBroadcast').prop('disabled', false);
              
            }

          });

         });


         $('#pdffilesBroadcast').on('change', function () {
          $('#BroadcastMess').prop('readonly', true)

         });



   

</script>    
<script>
    $('#Message').emojioneArea({
        pickerPosition:'bottom'
    });

    $('#txtcomposeArticle').emojioneArea({
        pickerPosition:'bottom'
    });

    $('#BroadcastMess').emojioneArea({
        pickerPosition:'bottom'
    });


    
</script>
       

